syntax = "proto3";

package tasks;

import "google/api/annotations.proto";

option go_package = "github.com/Novip1906/tasks-grpc/tasks/gen";

service TasksService {
    rpc CreateTask(CreateTaskRequest) returns (CreateTaskResponse) {
        option (google.api.http) = {
            post: "/tasks"
            body: "*"
        };
    }

    rpc GetTask(GetTaskRequest) returns (Task) {
        option (google.api.http) = {
            get: "/tasks/{taskId}"
        };
    }

    rpc SearchTask(SearchTasksRequest) returns (SearchTasksResponse) {
        option (google.api.http) = {
            get: "/tasks/search"
        };
    }

    rpc GetAllTasks(GetAllTasksRequest) returns (GetAllTasksResponse) {
        option (google.api.http) = {
            get: "/tasks"
        };
    }

    rpc UpdateTask(UpdateTaskRequest) returns (UpdateTaskResponse) {
        option (google.api.http) = {
            put: "/tasks/{taskId}"
            body: "*"
        };
    }

    rpc DeleteTask(DeleteTaskRequest) returns (DeleteTaskResponse) {
        option (google.api.http) = {
            delete: "/tasks/{taskId}"
        };
    }
}

message CreateTaskRequest {
    string text = 1;
}

message CreateTaskResponse {
    Task task = 1;
}

message GetTaskRequest {
    int64 taskId = 1;
}

message Task {
    int64 id = 1;
    string text = 2;
    string authorName = 3;
    int64 createdAt = 4;
}

message SearchTasksRequest {
    string query = 1;
}

message SearchTasksResponse {
    repeated Task tasks = 1;
}

message GetAllTasksRequest {

}

message GetAllTasksResponse {
    repeated Task tasks = 1;
}

message UpdateTaskRequest {
    int64 taskId = 1;
    string newText = 2;
}

message UpdateTaskResponse {
    
}

message DeleteTaskRequest {
    int64 taskId = 1;
}

message DeleteTaskResponse {
    Task task = 1;
}


// export PATH="$PATH:$(go env GOPATH)/bin"
// protoc -I . -I third_party/googleapis \
//   --go_out=. --go_opt=paths=source_relative \
//   --go-grpc_out=. --go-grpc_opt=paths=source_relative \
//   --grpc-gateway_out=. --grpc-gateway_opt=paths=source_relative \
//   tasks.proto