swagger: "2.0"
info:
  title: "Tasks & Auth API"
  version: "1.0.0"

schemes:
  - http
consumes:
  - application/json
produces:
  - application/json

paths:

  /auth/login:
    post:
      summary: Login
      operationId: AuthService_Login
      consumes:
        - application/json
      parameters:
        - in: body
          name: body
          schema:
            $ref: "#/definitions/LoginRequest"
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/LoginResponse"

  /auth/register:
    post:
      summary: Register
      operationId: AuthService_Register
      parameters:
        - in: body
          name: body
          schema:
            $ref: "#/definitions/RegisterRequest"
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/RegisterResponse"

  /auth/validate-code:
    post:
      summary: Validate verification code
      operationId: AuthService_ValidateVerificationCode
      parameters:
        - in: body
          name: body
          schema:
            $ref: "#/definitions/ValidateCodeRequest"
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/ValidateCodeResponse"

  /auth/change-email:
    post:
      summary: Change email
      operationId: AuthService_ChangeEmail
      parameters:
        - in: body
          name: body
          schema:
            $ref: "#/definitions/ChangeEmailRequest"
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/ChangeEmailResponse"

  /tasks:
    post:
      summary: Create task
      operationId: TasksService_CreateTask
      parameters:
        - in: body
          name: body
          schema:
            $ref: "#/definitions/CreateTaskRequest"
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/CreateTaskResponse"

    get:
      summary: Get all tasks
      operationId: TasksService_GetAllTasks
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/GetAllTasksResponse"

  /tasks/{taskId}:
    get:
      summary: Get a task
      operationId: TasksService_GetTask
      parameters:
        - name: taskId
          in: path
          required: true
          type: integer
          format: int64
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/Task"

    put:
      summary: Update task
      operationId: TasksService_UpdateTask
      parameters:
        - name: taskId
          in: path
          required: true
          type: integer
          format: int64
        - name: body
          in: body
          schema:
            $ref: "#/definitions/UpdateTaskRequest"
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/UpdateTaskResponse"

    delete:
      summary: Delete task
      operationId: TasksService_DeleteTask
      parameters:
        - name: taskId
          in: path
          required: true
          type: integer
          format: int64
      responses:
        "200":
          description: OK
          schema:
            $ref: "#/definitions/DeleteTaskResponse"

definitions:

  # AUTH MODELS

  LoginRequest:
    type: object
    properties:
      username:
        type: string
      password:
        type: string

  LoginResponse:
    type: object
    properties:
      token:
        type: string

  RegisterRequest:
    type: object
    properties:
      username:
        type: string
      email:
        type: string
      password:
        type: string

  RegisterResponse:
    type: object

  ValidateTokenRequest:
    type: object
    properties:
      token:
        type: string

  ValidateTokenResponse:
    type: object
    properties:
      userId:
        type: integer
        format: int64
      username:
        type: string
      email:
        type: string

  ValidateCodeRequest:
    type: object
    properties:
      email:
        type: string
      code:
        type: string

  ValidateCodeResponse:
    type: object

  ChangeEmailRequest:
    type: object
    properties:
      newEmail:
        type: string

  ChangeEmailResponse:
    type: object

  # TASKS MODELS

  CreateTaskRequest:
    type: object
    properties:
      text:
        type: string

  CreateTaskResponse:
    type: object
    properties:
      task:
        $ref: "#/definitions/Task"

  Task:
    type: object
    properties:
      id:
        type: integer
        format: int64
      text:
        type: string
      authorName:
        type: string
      createdAt:
        type: integer
        format: int64

  GetAllTasksRequest:
    type: object

  GetAllTasksResponse:
    type: object
    properties:
      tasks:
        type: array
        items:
          $ref: "#/definitions/Task"

  UpdateTaskRequest:
    type: object
    properties:
      taskId:
        type: integer
        format: int64
      newText:
        type: string

  UpdateTaskResponse:
    type: object

  DeleteTaskRequest:
    type: object
    properties:
      taskId:
        type: integer
        format: int64

  DeleteTaskResponse:
    type: object
    properties:
      task:
        $ref: "#/definitions/Task"
